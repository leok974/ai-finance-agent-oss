# Centralized security headers (single inclusion)
add_header X-Content-Type-Options "nosniff" always;
add_header X-Frame-Options "DENY" always;
add_header Referrer-Policy "no-referrer" always;
add_header Permissions-Policy "camera=(), microphone=(), geolocation=()" always;

# Unified CSP with placeholder for runtime inline script hashes
# Runtime script 10-csp-render.sh replaces or strips __INLINE_SCRIPT_HASHES__.
add_header Content-Security-Policy "default-src 'self'; img-src 'self' data: blob:; font-src 'self' data:; connect-src 'self' https: http:; script-src 'self' __INLINE_SCRIPT_HASHES__; style-src 'self'; object-src 'none'; base-uri 'self'; frame-ancestors 'none';" always;
